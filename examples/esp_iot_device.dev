Metadata
    name: "MyESP32Device"
    description: "My ESP32 IoT device"
    author: "klpanagi"
    os: RiotOS
end

Network
    ssid: "Wifi_2.4GHz"
    passwd: "guest"
end

Broker<MQTT>
    host: "node.mqtt.local"
    port: 1885
    auth:
        username: "guest"
        password: "guest"
end

Components
    board: ESP32Wroom32
    peripherals:
        - SonarSRF04
        - Mpl3115a2
        - BME680
end

Connection
    peripheral: SonarSRF04
    powerConnections:
        - gnd_1 -- gnd
        - power_5v -- vcc
    ioConnections:
        - type: gpio
          pin: p_13 -- trigger
        - type: gpio
          pin: p_14 -- echo
    endpoint:
	topic: "my_esp.sensors.distance.srf04_02"
        type: Publisher
end

Connection
    peripheral: Mpl3115a2
    powerConnections:
        - gnd_1 -- gnd
        - power_5v -- vcc
    ioConnections:
        - type: i2c
          slave_address: 0x78
          pins:
              sda: p_21 -- sda
              scl: p_22 -- scl
    endpoint:
	topic: "my_esp.sensors.distance.srf04_1"
        type: Publisher
end


Connection
    peripheral: BME680
    powerConnections:
        - gnd_1 -- gnd
        - power_5v -- vcc
    ioConnections:
        - type: i2c
          slave_address: 0x76
          pins:
              sda: p_21 -- sda
              scl: p_22 -- scl
    endpoint:
        topic: "my_esp.sensors.env.bme680"
        type: Publisher
end